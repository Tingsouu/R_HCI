---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(readr)

df <- read.csv("Data/SART_2.csv")
print(df)
df$summary <- rowSums(df[, c("Q1", "Q2", "Q3")]) - rowSums(df[, c("Q4", "Q5", "Q6", "Q7")]) + rowSums(df[, c("Q8", "Q9", "Q10")])
df$condition_road <- 0
df$NDRT <- 0

df[df$Condition == 1, c("condition_road")] <- "Straight"
df[df$Condition == 1, c("NDRT")] <- "Podcast"

df[df$Condition == 2, c("condition_road")] <- "Straight"
df[df$Condition == 2, c("NDRT")] <- "Game"

df[df$Condition == 3, c("condition_road")] <- "Winding"
df[df$Condition == 3, c("NDRT")] <- "Podcast"

df[df$Condition == 4, c("condition_road")] <- "Winding"
df[df$Condition == 4, c("NDRT")] <- "Game"
df
library(writexl)
#write_xlsx(df, "output2.xlsx")

```
```{r}
model <- aov(summary ~ condition_road * NDRT +Driving_Distance, data = df)
summary(model)
```

```{r}
library(ggplot2)


g1 <- ggplot(df, aes(x = factor(condition_road), y = summary, fill = NDRT)) +
  geom_boxplot() +
  labs(title = "SART scores by Condition ",
       x = "Conditions",
       y = ""
         
       ) 
    # Customize colors as needed

# Show the plot
print(g1)





# g3_3 ??
g3_3 <- ggplot(df, aes(x = factor(condition_road), y = summary, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.5), size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.5)) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.5), width = 0.2) +  # ?[?J error bar
  labs(title = "Summary by Condition",
       x = "Road"
       
       )


max_y <- max(df$summary)
g3_1 <- ggplot(df, aes(x = factor(condition_road), y = summary, fill = factor(NDRT))) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
  geom_text(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), vjust = -0.5, 
            aes(label = sprintf("Mean: %.2f\nSE: %.2f", after_stat(y), after_stat(ymax) - after_stat(y)))) +
  
  labs(title = "summary",
       x = "Road",
       y = "summary")+
  scale_y_continuous(limits = c(0, max_y + 0.5))




g3_1 <- ggplot(df, aes(x = factor(condition_road), y = summary, fill = NDRT)) +
  geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  labs(title = "(b) SART score by condition ",
       x = "Road",
       y = "SART score") +
  theme_minimal()   



#ggsave("grapht/SART.jpg", plot = g3_1, width = 6, height = 4, dpi = 600)
```



```{r}
library(ggplot2)
library(cowplot)
# è·‘è?‘meeting ???


```

```{r}
g4_1 <- ggplot(df, aes(x = factor(condition_road), y = Takeover_time, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = "dodge", size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Mean of mean_total by Condition",
       x = "Road",
       y = "Mean mean_total") # ?p?G?z?Q???C?? NDRT ????Ã¸?s?@???u?A?zÀ³?Ó±N group aesthetic ?]?m?? NDRT?A?o?Ë¨C?? NDRT ?N?|???Û¤v?????u

print(g4_1)
g4_2 <- ggplot(df, aes(x = factor(condition_road), y = Stable_time, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = "dodge", size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Mean of weight_total by Condition",
       x = "Road",
       y = "Mean weight_total")

print(g4_2)
```
```{r}
library(ggplot2)
library(patchwork)

# Your first plot
library(ggplot2)
library(patchwork)

# Your plot
g4_1 <- ggplot(df, aes(x = factor(condition_road), y = Takeover_time, group = factor(NDRT), color = NDRT, linetype = NDRT,shape = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 3) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75)) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.75), width = 0.25) +
  labs(title = "Mean of Takeover_time by Condition",
       x = "Road",
       y = "Mean of Takeover_time")

# Display the plot
g4_1

g4_1 <- ggplot(df, aes(x = factor(condition_road), y = Takeover_time, group = factor(NDRT), color = NDRT, linetype = NDRT, shape = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 3) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75)) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.75), width = 0.25) +
  scale_color_manual(values = c("blue", "red", "green"), name = "NDRT") +
  scale_linetype_manual(values = c("solid", "dashed", "dotted"), name = "NDRT") +
  scale_shape_manual(values = c(16, 17, 18), name = "NDRT") +
  labs(title = "Mean of Takeover_time by Condition",
       x = "Road",
       y = "Mean of Takeover_time")

# Display the plot
g4_1

# Your second plot
g4_2 <- ggplot(df, aes(x = factor(condition_road), y = Stable_time, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 3, shape = 17) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), linetype = "dashed") +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.75), width = 0.25) +
  labs(title = "Mean of Stable_time by Condition",
       x = "Road",
       y = "Mean of Stable_time")
g4_2
# Combine the two plots
#combined_plot <- g4_1 + g4_2

# Display the combined plot
#combined_plot




```

```{r}
df <- read.csv("Data/driving_behavior.csv")
print(df)
model <- aov(Accelero ~ condition_road * NDRT, data =df) #two way anova
summary(model)

model <- aov(Steering ~ condition_road * NDRT, data =df) #two way anova
summary(model)

model <- aov(Braking ~ condition_road * NDRT, data =df) #two way anova
summary(model)
```
```{r}
df$condition <- ifelse(df$condition_road == 1 & df$NDRT == 1, "Straight_Podcast",
                                
                       ifelse(df$condition_road == 1 & df$NDRT == 2, "Straight_Game",
                        ifelse(df$condition_road == 2 & df$NDRT == 1, "Winding_Podcast",
                          ifelse(df$condition_road == 2 & df$NDRT == 2, "Winding_Game",
                                            "OtherCondition"))))


df
df$condition_road <- ifelse(df$condition_road == 1 , "Straight",
                        ifelse(df$condition_road == 2, "Winding",
                                           "OtherCondition"))
df$NDRT <- ifelse(df$NDRT == 1 , "Low cognitive load",
                        ifelse(df$NDRT == 2, "High cognitive load",
                                           "OtherCondition"))
df
```

```{r}
library(ggplot2)
library(cowplot)
g1 <- ggplot(df, aes(x = factor(condition_road), y = Accelero, fill = NDRT)) +
  geom_boxplot() +
  labs(title = "Acceleration by condition ",
       x = "Condition",
       y = "Acceleration") 
    # Customize colors as needed

# Show the plot
print(g1)
g2 <- ggplot(df, aes(x = factor(condition_road), y = Steering, fill = NDRT)) +
  geom_boxplot() +
  labs(title = "Steering wheel degree by condition ",
       x = "Condition",
       y = "Steering wheel degree") 
    # Customize colors as needed

# Show the plot
print(g2)

g3 <- ggplot(df, aes(x = factor(condition_road), y = Braking, fill = NDRT)) +
  geom_boxplot() +
  labs(title = "Braking degree by condition ",
       x = "Condition",
       y = "Braking degree") 
    # Customize colors as needed

# Show the plot
print(g3)
```
```{r}
g4_1 <- ggplot(df, aes(x = factor(condition_road), y = Accelero, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = "dodge", size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Accelero by Condition ",
       x = "Condition",
       y = "Accelero") 

print(g4_1)
g4_2 <- ggplot(df, aes(x = factor(condition_road), y = Steering, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = "dodge", size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Steering by Condition ",
       x = "Condition",
       y = "Steering") 

print(g4_2)

g4_3 <- ggplot(df, aes(x = factor(condition_road), y = Braking, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = "dodge", size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = "dodge") +
  labs(title = "Braking by Condition ",
       x = "Condition",
       y = "Braking") 

print(g4_3)

```
```{r}
library(ggplot2)
library(patchwork)

# Function to add error bars
add_error_bars <- function(plot) {
  plot + geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.75), width = 0.25)
}

# Your first plot
g4_1 <- ggplot(df, aes(x = factor(condition_road), y = Accelero, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75)) +
  labs(title = "Accelero by Condition",
       x = "Condition",
       y = "Accelero")

# Add error bars to the first plot
g4_1_with_error_bars <- add_error_bars(g4_1)
g4_1_with_error_bars
# Your second plot
g4_2 <- ggplot(df, aes(x = factor(condition_road), y = Steering, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75)) +
  labs(title = "Steering by Condition",
       x = "Condition",
       y = "Steering")

# Add error bars to the second plot
g4_2_with_error_bars <- add_error_bars(g4_2)
g4_2_with_error_bars
# Your third plot
g4_3 <- ggplot(df, aes(x = factor(condition_road), y = Braking, group = factor(NDRT), color = NDRT)) +
  geom_point(stat = "summary", fun = "mean", position = position_dodge(width = 0.75), size = 2) +  
  geom_line(stat = "summary", fun = "mean", position = position_dodge(width = 0.75)) +
  labs(title = "Braking by Condition",
       x = "Condition",
       y = "Braking")

# Add error bars to the third plot
g4_3_with_error_bars <- add_error_bars(g4_3)
g4_3_with_error_bars
# Combine the three plots
#combined_plot <- g4_1_with_error_bars + g4_2_with_error_bars + g4_3_with_error_bars

# Display the combined plot
#combined_plot

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
