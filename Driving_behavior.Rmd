---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(readr)

df <- read.csv("Data/Driving_behavior.csv")

df <- na.omit(df) # delect NA
#df[df$condition == 1, c("condition_road")] <- "Straight"
#df[df$condition == 1, c("NDRT")] <- "Podcast"

#df[df$condition == 2, c("condition_road")] <- "Straight"
#df[df$condition == 2, c("NDRT")] <- "Game"

#df[df$condition == 3, c("condition_road")] <- "Winding"
#df[df$condition == 3, c("NDRT")] <- "Podcast"

#df[df$condition == 4, c("condition_road")] <- "Winding"
#df[df$condition == 4, c("NDRT")] <- "Game"

df[df$condition == 1, c("condition_road")] <- "Low"
df[df$condition == 1, c("NDRT")] <- "Low cognitive load"



df[df$condition == 2, c("condition_road")] <- "Low"
df[df$condition == 2, c("NDRT")] <- "High cognitive load"



df[df$condition == 3, c("condition_road")] <- "High"
df[df$condition == 3, c("NDRT")] <- "Low cognitive load"



df[df$condition == 4, c("condition_road")] <- "High"
df[df$condition == 4, c("NDRT")] <- "High cognitive load"
df
```
```{r}
model <- aov(Takeover_time ~ condition_road * NDRT, data =df) #two way anova
summary(model)
model <- aov(Takeover_time ~ condition_road * NDRT + Driving_Distance, data =df) #two way anova
summary(model)
model <- aov(Stable_Time ~ condition_road * NDRT +Driving_Distance, data =df) #two way anova
summary(model)
```
```{r}
model <- aov(Lateral_acceleration ~ condition_road * NDRT, data =df) #two way anova
summary(model)
```


```{r}
model <- aov(Maximum_Deceleration ~ condition_road * NDRT, data =df) #two way anova
summary(model)
TukeyHSD(model)
plot(TukeyHSD(model))
```


```{r}
model <- aov(F_TTL ~ condition_road * NDRT, data =df) #two way anova
summary(model)
```


```{r}
model <- aov(F_TTL ~ condition_road * NDRT, data =df) #two way anova
summary(model)
TukeyHSD(model)
plot(TukeyHSD(model))
```


```{r}
model <- aov(Large_Steering ~ condition_road * NDRT, data =df) #two way anova
summary(model)
```

```{r}

df_1 = subset(df, condition == 1)

df_1

sd_values <- apply(df_1, 2, sd)
print(sd_values)

```
```{r}
df_2 = subset(df, condition == 2)

df_2

sd_values <- apply(df_2, 2, sd)
print(sd_values)
```
```{r}
df_3 = subset(df, condition == 3)

df_3

sd_values <- apply(df_3, 2, sd)
print(sd_values)
```
```{r}
df_4 = subset(df, condition == 4)

df_4

sd_values <- apply(df_4, 2, sd)
print(sd_values)
```

```{r}
library(ggplot2)
library(dplyr)
library(gridExtra)
library(cowplot)
g_S <- ggplot(df, aes(x = factor(condition_road), y = Takeover_time, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", fun.args = list(mult = 1), position = position_dodge(width = 0.8), width = 0.3) +  
  
  
  labs(title = "Takeover time by condition",
       x = "situational complexity",
       y = "Takeover time (s)") +
    theme(legend.position = "none")

print(g_S)
ggsave("graph_ptt/Takeover_time.jpg", plot = g_S, width = 6, height = 4, dpi = 800)




#g3_1 <- ggplot(df, aes(x = factor(condition_road), y = Takeover_time, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Takeover_time by Condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g3_1)
#ggsave("graph_ppt/Takeover_time.jpg", plot = g3_12, width = 6, height = 4, dpi = 600)
```
```{r}
library(ggplot2)
library(dplyr)


gs2 <- ggplot(df, aes(x = factor(condition_road), y = Stable_Time, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
  
  
  labs(title = "Lane change time by condition ",
       x = "situational complexity",
       y = "Lane change time") +
  theme_minimal()  # è®¾ç½® y è½´è?ƒå›´ï¼Œæ?€å¤§å€¼å??0.5

print(gs2)
ggsave("graph_ptt/Stable_Time.jpg", plot = gs2, width = 6, height = 4, dpi = 600)

#g3_1 <- ggplot(df, aes(x = factor(condition_road), y = Stable_Time, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Lane change time by Condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g3_1)

#ggsave("graph/Stable_Time.pdf", plot = g3_1, width = 6, height = 4, dpi = 600)
```

```{r}
library(ggplot2)
g3_2 <- ggplot(df, aes(x = factor(condition_road), y = Lateral_acceleration, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
  #geom_text(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), vjust = -0.5, 
           # aes(label = sprintf("Mean: %.2f\nSE: %.2f", after_stat(y), after_stat(ymax) -after_stat(y)))) +  
  
  labs(title = "Lateral acceleration by condition ",
       x = "situational complexity",
       y = "Lateral acceleration") +
  theme_minimal()+
  theme(legend.position = "none")
ggsave("graph_ptt/Lateral acceleration.jpg", plot = g3_2, width = 6, height = 4, dpi = 600)
print(g3_2)
#g_Lateral_acceleration <- ggplot(df, aes(x = factor(condition_road), y = Lateral_acceleration, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Lateral_acceleration by Condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g_Lateral_acceleration)
#ggsave("graph/Lateral_acceleration.pdf", plot = g_Lateral_acceleration, width = 6, height = 4, dpi = 600)
```
```{r}
library(ggplot2)
g3_2 <- ggplot(df, aes(x = factor(condition_road), y = Maximum_Deceleration, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
  #geom_text(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), vjust = -0.5, 
            #aes(label = sprintf("Mean: %.2f\nSE: %.2f", after_stat(y), after_stat(ymax) -after_stat(y)))) +  
  
  labs(title = "Longitudinal deceleration by condition ",
       x = "situational complexity",
       y = "Longitudinal deceleration") +
  theme_minimal()+
  theme(legend.position = "none")
ggsave("graph_ptt/Maximum_Deceleration.jpg", plot = g3_2, width = 6, height = 4, dpi = 600)
 

#print(g3_2)
#g_Maximum_Deceleration <- ggplot(df, aes(x = factor(condition_road), y = Maximum_Deceleration, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Maximum_longitudinal_Deceleration by Condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g_Maximum_Deceleration)
#ggsave("graph/Maximum_Deceleration.pdf", plot = g_Maximum_Deceleration, width = 6, height = 4, dpi = 600)

 

```
```{r}
library(ggplot2)
g3_2 <- ggplot(df, aes(x = factor(condition_road), y = F_TTL, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
 
  
  labs(title = "Total acceleration by condition ",
       x = "situational complexity",
       y = "Total acceleration") 
 ggsave("graph_ptt/Total_acceleration.jpg", plot = g3_2, width = 6, height = 4, dpi = 600)

print(g3_2)
#g_Total_acceleration <- ggplot(df, aes(x = factor(condition_road), y = F_TTL, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Total_acceleration by Condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g_Total_acceleration)
#ggsave("grapht/Total_acceleration.pdf", plot = g_Total_acceleration, width = 6, height = 4, dpi = 600)
```
```{r}

```
```{r}
library(ggplot2)
g3_2 <- ggplot(df, aes(x = factor(condition_road), y = Large_Steering
, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), width = 0.3) +  
  #geom_text(stat = "summary", fun.data = "mean_se", position = position_dodge(width = 0.8), vjust = -0.5, 
            #aes(label = sprintf("Mean: %.2f\nSE: %.2f", after_stat(y), after_stat(ymax) -after_stat(y)))) +  
  
  labs(title = "Steering angle by condition",
       x = "situational complexity",
       y = "Steering angle") +
  theme_minimal()
ggsave("graph_ptt/Large_Steering.jpg", plot = g3_2, width = 6, height = 4, dpi = 600)
 

print(g3_2)
#g3_1 <- ggplot(df, aes(x = factor(condition_road), y = Large_Steering, fill = NDRT)) +
  #geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  #labs(title = "Large steering angle by condition ",
       #x = "situational complexity",
       #y = "") +
  #theme_minimal()   

#print(g3_1)
#ggsave("grapht/Large_Steering.pdf", plot = g3_1, width = 6, height = 4, dpi = 600)
```

```{r}
# merage graph
library(gridExtra)
merged_plot <- grid.arrange(g_Lateral_acceleration, g_Maximum_Deceleration, ncol = 2, padding = 2.2)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.