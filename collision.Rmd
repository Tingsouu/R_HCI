---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(readr)

df <- read.csv("Data/collision.csv")

df <- na.omit(df) # delect NA

df
```
```{r}


df[df$condition == 1, c("condition_road")] <- "Straight"
df[df$condition == 1, c("NDRT")] <- "Podcast"

df[df$condition == 2, c("condition_road")] <- "Straight"
df[df$condition == 2, c("NDRT")] <- "Game"

df[df$condition == 3, c("condition_road")] <- "Winding"
df[df$condition == 3, c("NDRT")] <- "Podcast"

df[df$condition == 4, c("condition_road")] <- "Winding"
df[df$condition == 4, c("NDRT")] <- "Game"
df
```
```{r}
model <- aov(Collision ~ condition_road * NDRT, data =df) #two way anova
summary(model)

model <- aov(Collision ~ condition_road * NDRT+Driving_Distance, data =df) #two way anova
summary(model)
```

```{r}
library(ggplot2)
library(dplyr)
g_S <- ggplot(df, aes(x = factor(condition_road), y = Collision, fill = NDRT)) +
  geom_bar(stat = "summary", fun = "mean", position = position_dodge(width = 0.8), width = 0.7) +
  geom_errorbar(stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1), position = position_dodge(width = 0.8), width = 0.3) +  
  geom_text(stat = "summary", fun.data = "mean_sdl", fun.args = list(mult = 1), position = position_dodge(width = 0.8), vjust = -0.5, 
            aes(label = sprintf("Mean: %.2f\nSD: %.2f", after_stat(y), after_stat(ymax) - after_stat(y)))) +
  
  labs(title = "(b) SART score by condition",
       x = "situational complexity",
       y = "") 
print(g_S)


print(g3_1)
g3_1 <- ggplot(df, aes(x = factor(condition_road), y = Collision, fill = NDRT)) +
  geom_boxplot(position = position_dodge(width = 0.8), width = 0.7) +  # ä½¿ç”¨??’å½¢?›¾
  
  labs(title = "Collision by condition",
       x = "Road",
       y = "Collsion_time") +
  theme_minimal()   

print(g3_1)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.